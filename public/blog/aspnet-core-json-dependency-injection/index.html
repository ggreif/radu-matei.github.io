<!DOCTYPE HTML>

<html>
    <head>
        
            
                <title>Inject ASP.NET Core Dependencies from JSON files</title>
            
        

        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="generator" content="Hugo 0.57.2" />
        


        
            <meta name="author" content="Radu Matei">
        
        
            
                <meta name="description" content="Radu M - Kubernetes, containers and cloud native open-source developer tools. Debugging distributed systems. Software Engineer @Microsoft @Azure. Opinions are my own.">
            
        

        <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Inject ASP.NET Core Dependencies from JSON files"/>
<meta name="twitter:description" content="Back in the days of ASP.NET 4.x, each of the framework components - MVC, WebAPI, OWIN, SignalR - had its own dependency resolver and its own way of integrating with the framework. ASP.NET Core brings a consistent dependency injection mechanism with a unified meaning for lifetime or service registration,that is designed to server the needs of the framework and most consumer applications built on it. In this article, we will see a way of defining the service types and the implementation types we want to use based on a JSON file and switch between implementations without changing the code."/>
<meta name="twitter:site" content="@matei_radu"/>

        <meta property="og:title" content="Inject ASP.NET Core Dependencies from JSON files" />
<meta property="og:description" content="Back in the days of ASP.NET 4.x, each of the framework components - MVC, WebAPI, OWIN, SignalR - had its own dependency resolver and its own way of integrating with the framework. ASP.NET Core brings a consistent dependency injection mechanism with a unified meaning for lifetime or service registration,that is designed to server the needs of the framework and most consumer applications built on it. In this article, we will see a way of defining the service types and the implementation types we want to use based on a JSON file and switch between implementations without changing the code." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://radu-matei.com/blog/aspnet-core-json-dependency-injection/" />
<meta property="article:published_time" content="2016-08-18T00:00:00+00:00" />
<meta property="article:modified_time" content="2016-08-18T00:00:00+00:00" />

        <meta itemprop="name" content="Inject ASP.NET Core Dependencies from JSON files">
<meta itemprop="description" content="Back in the days of ASP.NET 4.x, each of the framework components - MVC, WebAPI, OWIN, SignalR - had its own dependency resolver and its own way of integrating with the framework. ASP.NET Core brings a consistent dependency injection mechanism with a unified meaning for lifetime or service registration,that is designed to server the needs of the framework and most consumer applications built on it. In this article, we will see a way of defining the service types and the implementation types we want to use based on a JSON file and switch between implementations without changing the code.">


<meta itemprop="datePublished" content="2016-08-18T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2016-08-18T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="1122">



<meta itemprop="keywords" content="" />

        

        

        
        
            
        

        
        
            <link rel="stylesheet" href="/css/google-font.css" />
            <link rel="stylesheet" href="/css/font-awesome.min.css" />
            <link rel="stylesheet" href="/css/main.css" />
            <link rel="stylesheet" href="/css/add-on.css" />
            <link rel="stylesheet" href="/css/monokai-sublime.css">
        

        

        
        
        
            
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-81142224-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

        
    </head>
    <body>

        
        <div id="wrapper">

    
    
<header id="header">
    
    <h2><a href="/">Radu M</i></a></h2>
    

    <nav class="links">
        <ul>
            
            
            
            <li>
                <a href="/blog" >
                    
                    <i class="fa fa-newspaper-o">&nbsp;</i>Blog
                </a>
            </li>
            
            
            
            <li>
                <a href="/about" >
                    
                    <i class="fa fa-smile-o">&nbsp;</i>About
                </a>
            </li>
            
            
            
            <li>
                <a href="/speaking" >
                    
                    <i class="fa fa-comments-o">&nbsp;</i>Speaking
                </a>
            </li>
            
            
            
            <li>
                <a href="/contact" >
                    
                    <i class="fa fa-envelope-o">&nbsp;</i>Contact
                </a>
            </li>
            
            
            
            <li>
                <a href="https://github.com/radu-matei"  target="_blank" >
                    
                    <i class="fa fa-github">&nbsp;</i>Open Source
                </a>
            </li>
            
            
            
            <li>
                <a href="https://twitter.com/matei_radu"  target="_blank" >
                    
                    <i class="fa fa-twitter">&nbsp;</i>Tweets
                </a>
            </li>
            
        </ul>
    </nav>
    <nav class="main">
        <ul>
            
            <li id="share-nav" class="share-menu" style="display:none;">
                <a class="fa-share-alt" href="#share-menu">Share</a>
            </li>
            
            <li class="search">
                <a class="fa-search" href="#search">Search</a>
                <form id="search" method="get" action="//google.com/search">
                    <input type="text" name="q" placeholder="Search" />
                    <input type="hidden" name="q" value="site:https://radu-matei.com">
                </form>
            </li>
            <li class="menu">
                <a class="fa-bars" href="#menu">Menu</a>
            </li>
        </ul>
    </nav>
</header>


<section id="menu">

    
    <section>
        <form class="search" method="get" action="//google.com/search">
            <input type="text" name="q" placeholder="Search" />
            <input type="hidden" name="q" value="site:https://radu-matei.com">
        </form>
    </section>

    
    <section>
        <ul class="links">
            
            
            
            <li>
                <a href="/blog" >
                    <h3>
                        
                        <i class="fa fa-newspaper-o">&nbsp;</i>
                        
                        Blog
                    </h3>
                </a>
            </li>
            
            
            
            <li>
                <a href="/about" >
                    <h3>
                        
                        <i class="fa fa-smile-o">&nbsp;</i>
                        
                        About
                    </h3>
                </a>
            </li>
            
            
            
            <li>
                <a href="/speaking" >
                    <h3>
                        
                        <i class="fa fa-comments-o">&nbsp;</i>
                        
                        Speaking
                    </h3>
                </a>
            </li>
            
            
            
            <li>
                <a href="/contact" >
                    <h3>
                        
                        <i class="fa fa-envelope-o">&nbsp;</i>
                        
                        Contact
                    </h3>
                </a>
            </li>
            
            
            
            <li>
                <a href="https://github.com/radu-matei"  target="_blank" >
                    <h3>
                        
                        <i class="fa fa-github">&nbsp;</i>
                        
                        Open Source
                    </h3>
                </a>
            </li>
            
            
            
            <li>
                <a href="https://twitter.com/matei_radu"  target="_blank" >
                    <h3>
                        
                        <i class="fa fa-twitter">&nbsp;</i>
                        
                        Tweets
                    </h3>
                </a>
            </li>
            
        </ul>
    </section>

    
    <section>
        <ul class="links">
            <header>
                <h3>Recent Posts</h3>
            </header>
            
            
            

            
            <li>
                <a href="https://radu-matei.com/blog/building-github-actions/">
                    <p>Building Reusable GitHub Actions in TypeScript, using the official toolkit</p>
                </a>
            </li>
            
            <li>
                <a href="https://radu-matei.com/blog/kubernetes-e2e-github-actions/">
                    <p>Running Kubernetes end-to-end tests with Kind and GitHub Actions</p>
                </a>
            </li>
            
            <li>
                <a href="https://radu-matei.com/blog/kubernetes-e2e-kind-brigade/">
                    <p>Running end-to-end tests on your Kubernetes cluster with Kind and Brigade</p>
                </a>
            </li>
            
            <li>
                <a href="https://radu-matei.com/blog/helm-wasm/">
                    <p>Rendering Helm templates in the browser, with Web Assembly</p>
                </a>
            </li>
            
            <li>
                <a href="https://radu-matei.com/blog/kubernetes-controller-csharp/">
                    <p>Writing controllers for Kubernetes CRDs with C#</p>
                </a>
            </li>
            
        </ul>
    </section>

    
    
</section>
    <section id="share-menu">
    <section id="social-share-nav">
        <ul class="links">
            <header>
                <h3>Share this post <i class="fa fa-smile-o"></i></h3>
            </header>
            


<li><a href="//twitter.com/share?url=https%3a%2f%2fradu-matei.com%2fblog%2faspnet-core-json-dependency-injection%2f&text=Inject%20ASP.NET%20Core%20Dependencies%20from%20JSON%20files&via=matei_radu" target="_blank" class="share-btn twitter">
    <i class="fa fa-twitter"></i>
    <p>Twitter</p>
</a></li>


<li><a href="//plus.google.com/share?url=https%3a%2f%2fradu-matei.com%2fblog%2faspnet-core-json-dependency-injection%2f" target="_blank" class="share-btn google-plus">
    <i class="fa fa-google-plus"></i>
    <p>Google+</p>
</a></li>


<li><a href="//www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fradu-matei.com%2fblog%2faspnet-core-json-dependency-injection%2f" target="_blank" class="share-btn facebook">
    <i class="fa fa-facebook"></i>
    <p>Facebook</p>
</a></li>


<li><a href="//reddit.com/submit?url=https%3a%2f%2fradu-matei.com%2fblog%2faspnet-core-json-dependency-injection%2f&title=Inject%20ASP.NET%20Core%20Dependencies%20from%20JSON%20files" target="_blank" class="share-btn reddit">
    <i class="fa fa-reddit-alien"></i>
    <p>Reddit</p>
</a></li>


<li><a href="//www.linkedin.com/shareArticle?url=https%3a%2f%2fradu-matei.com%2fblog%2faspnet-core-json-dependency-injection%2f&title=Inject%20ASP.NET%20Core%20Dependencies%20from%20JSON%20files" target="_blank" class="share-btn linkedin">
    <i class="fa fa-linkedin"></i>
    <p>LinkedIn</p>
</a></li>


<li><a href="//www.stumbleupon.com/submit?url=https%3a%2f%2fradu-matei.com%2fblog%2faspnet-core-json-dependency-injection%2f&title=Inject%20ASP.NET%20Core%20Dependencies%20from%20JSON%20files" target="_blank" class="share-btn stumbleupon">
    <i class="fa fa-stumbleupon"></i>
    <p>StumbleUpon</p>
</a></li>


<li><a href="mailto:?subject=Check out this post by Radu%20Matei&body=https%3a%2f%2fradu-matei.com%2fblog%2faspnet-core-json-dependency-injection%2f" target="_blank" class="share-btn email">
    <i class="fa fa-envelope"></i>
    <p>Email</p>
</a></li>

        </ul>
    </section>
</section>

    
    <div id="main">
        
        
        <article class="post">
    <header>
    <div class="title">
        
            <h1><a href="https://radu-matei.com/blog/aspnet-core-json-dependency-injection/">Inject ASP.NET Core Dependencies from JSON files</a></h1>
            
        
        
    </div>
    <div class="meta">
        
            
        

        <time class="published"
            datetime='2016-08-18'>
            August 18, 2016</time>
        <span class="author">Radu Matei</span>
        
            <p>6 minute read</p>
        
        
    </div>
</header>


    <section id="social-share">
        <ul class="icons">
            


<li><a href="//twitter.com/share?url=https%3a%2f%2fradu-matei.com%2fblog%2faspnet-core-json-dependency-injection%2f&text=Inject%20ASP.NET%20Core%20Dependencies%20from%20JSON%20files&via=matei_radu" target="_blank" class="share-btn twitter">
    <i class="fa fa-twitter"></i>
    <p>Twitter</p>
</a></li>


<li><a href="//plus.google.com/share?url=https%3a%2f%2fradu-matei.com%2fblog%2faspnet-core-json-dependency-injection%2f" target="_blank" class="share-btn google-plus">
    <i class="fa fa-google-plus"></i>
    <p>Google+</p>
</a></li>


<li><a href="//www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fradu-matei.com%2fblog%2faspnet-core-json-dependency-injection%2f" target="_blank" class="share-btn facebook">
    <i class="fa fa-facebook"></i>
    <p>Facebook</p>
</a></li>


<li><a href="//reddit.com/submit?url=https%3a%2f%2fradu-matei.com%2fblog%2faspnet-core-json-dependency-injection%2f&title=Inject%20ASP.NET%20Core%20Dependencies%20from%20JSON%20files" target="_blank" class="share-btn reddit">
    <i class="fa fa-reddit-alien"></i>
    <p>Reddit</p>
</a></li>


<li><a href="//www.linkedin.com/shareArticle?url=https%3a%2f%2fradu-matei.com%2fblog%2faspnet-core-json-dependency-injection%2f&title=Inject%20ASP.NET%20Core%20Dependencies%20from%20JSON%20files" target="_blank" class="share-btn linkedin">
    <i class="fa fa-linkedin"></i>
    <p>LinkedIn</p>
</a></li>


<li><a href="//www.stumbleupon.com/submit?url=https%3a%2f%2fradu-matei.com%2fblog%2faspnet-core-json-dependency-injection%2f&title=Inject%20ASP.NET%20Core%20Dependencies%20from%20JSON%20files" target="_blank" class="share-btn stumbleupon">
    <i class="fa fa-stumbleupon"></i>
    <p>StumbleUpon</p>
</a></li>


<li><a href="mailto:?subject=Check out this post by Radu%20Matei&body=https%3a%2f%2fradu-matei.com%2fblog%2faspnet-core-json-dependency-injection%2f" target="_blank" class="share-btn email">
    <i class="fa fa-envelope"></i>
    <p>Email</p>
</a></li>

        </ul>
    </section>
    

    <div id="content">
        

<h2 id="table-of-content">Table of Content</h2>

<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#the-need-for-registering-services-through-a-json-file">The need for registering services through a JSON file</a></li>
<li><a href="#adding-the-required-packages">Adding the required packages</a></li>
<li><a href="#creating-a-dummy-service">Creating a dummy service</a></li>
<li><a href="#how-to-inject-an-itest-service">How to inject an <code>ITest</code> service</a></li>
<li><a href="#the-json-file">The JSON file</a></li>
<li><a href="#the-service-class">The <code>Service</code> class</a></li>
<li><a href="#adding-the-services">Adding the services</a></li>
<li><a href="#testing-the-application">Testing the application</a></li>
<li><a href="#the-startup-class">The <code>Startup</code> class</a></li>
<li><a href="#conclusion">Conclusion</a></li>
</ul>

<h2 id="introduction">Introduction</h2>

<p>&ldquo;Back in the days&rdquo; of ASP.NET 4.x, each of the framework components (MVC, WebAPI, OWIN, SignalR) had its own dependency resolver and its own way of integrating with the framework.</p>

<p>For example, if you had an application that used MVC/WebAPI, OWIN and SignalR and you wanted to use <a href="http://autofac.readthedocs.io/en/latest/index.html" target="_blank">Autofac</a>, you would have needed individual integrations, with different method names (see <a href="http://autofac.readthedocs.io/en/latest/integration/mvc.html#register-controllers" target="_blank"><code>RegisterControllers</code></a> for MVC and <a href="http://autofac.readthedocs.io/en/latest/integration/webapi.html#register-controllers" target="_blank"><code>RegisterApiControllers</code></a> for WebAPI), different NuGet packages (see <a href="https://www.nuget.org/packages/Autofac.WebApi2/" target="_blank">the package for WebAPI</a> and <a href="https://www.nuget.org/packages/Autofac.Mvc5/" target="_blank">the package for MVC</a>) and different dependency resolvers and you even needed to take care at the order in which you replaced the dependency resolvers for these components.</p>

<p>ASP.NET Core brings a consistent dependency injection mechanism with a unified meaning for lifetime or service registration,that is designed to server the needs of the framework &ldquo;and most consumer applications built on it&rdquo; (<a href="https://docs.asp.net/en/latest/fundamentals/dependency-injection.html#replacing-the-default-services-container" target="_blank">as the documentation states</a>).</p>

<p>Of course, you can replace the default DI engine that comes with the framework and use <a href="http://autofac.readthedocs.io/en/latest/integration/aspnetcore.html" target="_blank">Autofac</a>, <a href="https://www.nuget.org/packages/DryIoc.Microsoft.DependencyInjection" target="_blank">Dryloc</a>, <a href="https://www.nuget.org/packages/Grace.DependencyInjection.Extensions" target="_blank">Grace</a>, <a href="https://github.com/seesharper/LightInject.Microsoft.DependencyInjection" target="_blank">LightInject</a> or <a href="https://github.com/structuremap/StructureMap.Microsoft.DependencyInjection" target="_blank">StructureMap</a> and in a future article, we will probably explore a couple of them.</p>

<blockquote>
<p>In this article, we will see a way of defining the service types and the implementation types we want to use based on a JSON file and switch between implementations without changing the code.</p>

<p>This is a feature in Autofac for ASP.NET and you can <a href="http://docs.autofac.org/en/latest/configuration/xml.html" target="_blank">find it documented here</a>, but we will implement a very basic way of adding services using only the built-in mechanism.</p>

<p>Also, it will not use the <a href="https://radu-matei.github.io/blog/aspnet-core-configuration-greeting/" target="_blank">JSON configuration provider</a>.</p>
</blockquote>

<h2 id="the-need-for-registering-services-through-a-json-file">The need for registering services through a JSON file</h2>

<p>A very simple reason to think about using a JSON file when registering DI services is because you might not know (or cannot choose) the concrete implementation at compile-time.</p>

<p>Another reason could be for switching implementations for testing purposes.</p>

<blockquote>
<p>You can also <a href="https://docs.asp.net/en/latest/fundamentals/environments.html" target="_blank">work with multiple environments</a> and have <code>Startup{EnvironmentName}</code> class for each environment - dev, testing, production and set the environment variable before running the application.</p>
</blockquote>

<p>But for this article, I thought it would be cool to inject the required dependencies based on a JSON file without using any DI engine other than the built-in one from ASP.NET Core.</p>

<h2 id="adding-the-required-packages">Adding the required packages</h2>

<p>Since this is going to be a web app, we need the Kestrel web server package (Microsoft.AspNetCore.Server.Kestrel). As I said earlier, we are not going to use the JSON Configuration provider (at this point), so we will only need a library to deserialize (part of) JSON, and we will use Newtonsoft.Json.</p>

<h2 id="creating-a-dummy-service">Creating a dummy service</h2>

<p>We are going to need a very simple service to inject in our application:</p>

<pre><code>public interface ITest
{
    string DoSomething(string parameter);
}
</code></pre>

<p>And an even simpler implementation:</p>

<pre><code>public class Test : ITest
{
    public string DoSomething(string parameter)
    {
        return $&quot;Message from Test with { parameter }&quot;;
    }
}
</code></pre>

<h2 id="how-to-inject-an-itest-service">How to inject an <code>ITest</code> service</h2>

<p>In order to inject a service of type <code>ITest</code>, you need to add a function in <code>Startup</code> called <code>ConfigureServices</code> that has a parameter of type <code>IServiceCollection</code> and add the service in this collection.</p>

<pre><code>public void ConfigureServices(IServiceCollection services)
{
    services.Add(new ServiceDescriptor(serviceType: typeof(ITest), 
                                       implementationType: typeof(Test), 
                                       lifetime: ServiceLifetime.Transient));
}
</code></pre>

<p>Now, every time a component will request an instance of <code>ITest</code>, the framework will provide <em>another</em> instance of <code>Test</code>, since the lifetime is passed as <em>Transient</em>.</p>

<blockquote>
<p><a href="https://docs.asp.net/en/latest/fundamentals/dependency-injection.html" target="_blank">Transient objects are always different; a new instance is provided to every controller and every service.</a></p>
</blockquote>

<h2 id="the-json-file">The JSON File</h2>

<p>Since we will use a JSON file, it might as well be the one we use for other configurations (or a completely different one). Regardless of what you choose, you can extract only the relevant part of the JSON file using a section name.</p>

<pre><code>{
    &quot;services&quot;: [
        {
            &quot;serviceType&quot;: &quot;ITest&quot;,
            &quot;implementationType&quot;: &quot;Test&quot;,
            &quot;lifetime&quot;: &quot;Transient&quot;
        }
    ],

    &quot;otherConfigurations&quot;: {
        &quot;someKey&quot;: &quot;someValue&quot;,
        &quot;otherKey&quot;: &quot;otherValue&quot;
    }
}
</code></pre>

<p>In this case, the JSON section we are interested in is <code>services</code>. At this key, we have an array of JSON objects with 3 properties: <code>serviceType</code>, <code>implementationType</code> and <code>lifetime</code>, which correspond to the parameters passed to the <code>ServiceDescriptor</code> when adding the service.</p>

<h2 id="the-service-class">The <code>Service</code> class</h2>

<p>These 3 properties are mapped into a class called <code>Service</code>. For simplicity, the <code>ServiceType</code> and <code>ImplementationType</code> properties are of type <code>string</code>, but you can always implement a <code>JsonConverter</code> that maps them to the type <code>Type</code> (There is no immediate conversion from <code>string</code> to <code>Type</code>).</p>

<p>Since <code>Newtonsoft</code> has implemented the conversion from <code>string</code> to <code>enum</code>, we used it here to convert to <code>ServiceLifetime</code> enum from <code>Microsoft.Extensions.DependencyInjection</code>.</p>

<pre><code>using Microsoft.Extensions.DependencyInjection;
using Newtonsoft.Json;
using Newtonsoft.Json.Converters;

public class Service
{
    public string ServiceType { get; set; }

    public string ImplementationType { get;set; }

    [JsonConverter(typeof(StringEnumConverter))]
    public ServiceLifetime Lifetime { get; set; }
}
</code></pre>

<h2 id="adding-the-services">Adding the services</h2>

<p>Next, in the <code>Startup</code> class we will simply deserialize the JSON section into a <code>List&lt;Service&gt;</code>, iterate through it and add the services:</p>

<pre><code>private void ConfigureJsonServices(IServiceCollection services)
{
    var jsonServices = JObject.Parse(File.ReadAllText(&quot;appSettings.json&quot;))[&quot;services&quot;];
    var requiredServices = JsonConvert.DeserializeObject&lt;List&lt;Service&gt;&gt;(jsonServices.ToString());

    foreach(var service in requiredServices)
    {
         services.Add(new ServiceDescriptor(serviceType: Type.GetType(service.ServiceType),
                                            implementationType: Type.GetType(service.ImplementationType),
                                            lifetime: service.Lifetime));
    }
}
</code></pre>

<p>Then, in the <code>ConfigureServices</code> method, call this method with the <code>services</code> argument.</p>

<h2 id="testing-the-application">Testing the application</h2>

<p>The first thing we can do is to add a breakpoint after executing the <code>ConfigureJsonServices</code> method.</p>

<p><img src="/img/article-photos/aspnet-core-json-dependency-injection/services-breakpoint.JPG" alt="" /></p>

<p>We can see that our <code>ITest</code> service was added and now we can inject it anywhere in our application.</p>

<p>At this point, we can also inject an instance of the service in the <code>Configure</code> method and have a message returned from the service:</p>

<pre><code>    public void Configure(IApplicationBuilder app, ITest test)
    {
        app.Run(context =&gt;
        {
            var response = test.DoSomething(&quot;startup&quot;);
            return context.Response.WriteAsync(response);
        });
    }
</code></pre>

<p>Every time you need to provide another implementation for a service, you don&rsquo;t have to recompile the entire application, simply modify the JSON file and start the application again.</p>

<h2 id="the-startup-class">The <code>Startup</code> class</h2>

<pre><code>using System;
using System.IO;
using System.Collections.Generic;
using Microsoft.AspNetCore.Builder;
using Microsoft.AspNetCore.Hosting;
using Microsoft.AspNetCore.Http;
using Microsoft.Extensions.DependencyInjection;
using Newtonsoft.Json;
using Newtonsoft.Json.Linq;

public class Startup
{
    public void ConfigureServices(IServiceCollection services)
    {
        ConfigureJsonServices(services);
    }

    public void Configure(IApplicationBuilder app, ITest test)
    {
        app.Run(context =&gt;
        {
            var response = test.DoSomething(&quot;startup&quot;);
            return context.Response.WriteAsync(response);
        });
    }

    private void ConfigureJsonServices(IServiceCollection services)
    {
        var jsonServices = JObject.Parse(File.ReadAllText(&quot;appSettings.json&quot;))[&quot;services&quot;];
        var requiredServices = JsonConvert.DeserializeObject&lt;List&lt;Service&gt;&gt;(jsonServices.ToString());

        foreach(var service in requiredServices)
        {
            services.Add(new ServiceDescriptor(serviceType: Type.GetType(service.ServiceType),
                                               implementationType: Type.GetType(service.ImplementationType),
                                               lifetime: service.Lifetime));
        }
    }
}
</code></pre>

<h2 id="conclusion">Conclusion</h2>

<p>This is a very basic and rudimentary way of injecting dependencies in the application. It is by no means production ready, it doesn&rsquo;t deal with exceptions, services that don&rsquo;t exist or incorrect lifetimes.</p>

<p>It is only a simple alternative to registering each service manually, in code, recompiling the entire application every time you needed to swap some services.</p>

    </div>
        

        
    <footer>
        <ul class="stats">
    
        

        
        
            <li>
                
                
                    

                    
                        Categories
                    
                
            </li>
        
    

    
    
        <li><a href='/categories/aspnet-core'>aspnet-core</a></li>
    
        <li><a href='/categories/dependency-injection'>dependency-injection</a></li>
    
</ul>

    </footer>
</article>
<ul class="actions pagination">
    
        <li><a href="https://radu-matei.com/blog/aspnet-core-api/"
                class="button big previous">Introduction to ASP .NET Core MVC API</a></li>
    

    
        <li><a href="https://radu-matei.com/blog/aspnet-core-mvc-signalr/"
                class="button big next">ASP.NET Core MVC and SignalR Core</a></li>
    
</ul>


<article class="post">
    <div id="disqus_thread"></div>


<script type="text/javascript">
    var disqus_shortname = 'radu-matei';
    var disqus_identifier = "https://radu-matei.com/blog/aspnet-core-json-dependency-injection/";
    var disqus_title = "Inject ASP.NET Core Dependencies from JSON files";
    var disqus_url = "Inject ASP.NET Core Dependencies from JSON files";

    var disqus_config = function () {
        this.page.url = "https://radu-matei.com/blog/aspnet-core-json-dependency-injection/";  
        this.page.identifier = "https://radu-matei.com/blog/aspnet-core-json-dependency-injection/"; 
    };

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</article>
    </div>
         
    
<section id="sidebar">

    
        <section id="intro">
            
            
                
                    <img src="/img/main/profile.jpg" class="intro-circle" width="150" alt="Radu" />
                
            
            
                <header>
                   <a href="/"> <h2>Radu M</h2></a>
                    <p>Kubernetes, containers and cloud native open-source developer tools. Debugging distributed systems. Software Engineer @Microsoft @Azure. Opinions are my own.</p>
                </header>
            
            <ul class="icons">
                
                
                    
<li><a href="//github.com/radu-matei" target="_blank" title="GitHub" class="fa fa-github"></a></li>



















<li><a href="//instagram.com/iamradum" target="_blank" title="Instagram" class="fa fa-instagram"></a></li>

















<li><a href="//linkedin.com/in/mateiradu" target="_blank" title="LinkedIn" class="fa fa-linkedin"></a></li>















<li><a href="//twitter.com/matei_radu" target="_blank" title="Twitter" class="fa fa-twitter"></a></li>



<li><a href="mailto:root@radu.sh" title="Email" class="fa fa-envelope"></a></li>


                
            </ul>
        </section>

    
        <section id="recent-posts">
            <ul class="posts">
                <header>
                    <h3>Recent Posts</h3>
                </header>
                
                    
                

                
                    
                

                
                    <li>
                        <article>
                            <header>
                                <h3><a href="https://radu-matei.com/blog/building-github-actions/">Building Reusable GitHub Actions in TypeScript, using the official toolkit</a></h3>
                                
                                    
                                
                                <time class="published" datetime=
                                    '2019-08-23'>
                                    August 23, 2019</time>
                            </header>
                        </article>
                    </li>
                
                    <li>
                        <article>
                            <header>
                                <h3><a href="https://radu-matei.com/blog/kubernetes-e2e-github-actions/">Running Kubernetes end-to-end tests with Kind and GitHub Actions</a></h3>
                                
                                    
                                
                                <time class="published" datetime=
                                    '2019-08-21'>
                                    August 21, 2019</time>
                            </header>
                        </article>
                    </li>
                
                    <li>
                        <article>
                            <header>
                                <h3><a href="https://radu-matei.com/blog/kubernetes-e2e-kind-brigade/">Running end-to-end tests on your Kubernetes cluster with Kind and Brigade</a></h3>
                                
                                    
                                
                                <time class="published" datetime=
                                    '2019-08-10'>
                                    August 10, 2019</time>
                            </header>
                        </article>
                    </li>
                
                    <li>
                        <article>
                            <header>
                                <h3><a href="https://radu-matei.com/blog/helm-wasm/">Rendering Helm templates in the browser, with Web Assembly</a></h3>
                                
                                    
                                
                                <time class="published" datetime=
                                    '2019-05-11'>
                                    May 11, 2019</time>
                            </header>
                        </article>
                    </li>
                
                    <li>
                        <article>
                            <header>
                                <h3><a href="https://radu-matei.com/blog/kubernetes-controller-csharp/">Writing controllers for Kubernetes CRDs with C#</a></h3>
                                
                                    
                                
                                <time class="published" datetime=
                                    '2019-05-06'>
                                    May 6, 2019</time>
                            </header>
                        </article>
                    </li>
                

                
                    <li>
                        <ul class="actions">
                            <li><a href=
                            
                                /blog/
                            
                            class="button">View more posts</a></li>
                        </ul>
                    </li>
                
            </ul>
        </section>

    
    
    
    
        <section id="categories">
            <ul class="posts">
                <header>
                    <h3><a href="/categories/">Categories</a></h3>
                </header>

                
                    
                

                
                    <li>
                        <article>
                            <header>
                                <a href="/categories/kubernetes/">kubernetes</a>
                                <span style="float:right;">12</span>
                            </header>
                        </article>
                    </li>
                
                    <li>
                        <article>
                            <header>
                                <a href="/categories/aspnet-core/">aspnet-core</a>
                                <span style="float:right;">11</span>
                            </header>
                        </article>
                    </li>
                
                    <li>
                        <article>
                            <header>
                                <a href="/categories/azure/">azure</a>
                                <span style="float:right;">7</span>
                            </header>
                        </article>
                    </li>
                
                    <li>
                        <article>
                            <header>
                                <a href="/categories/docker/">docker</a>
                                <span style="float:right;">4</span>
                            </header>
                        </article>
                    </li>
                
                    <li>
                        <article>
                            <header>
                                <a href="/categories/signalr/">signalr</a>
                                <span style="float:right;">4</span>
                            </header>
                        </article>
                    </li>
                
                    <li>
                        <article>
                            <header>
                                <a href="/categories/dependency-injection/">dependency-injection</a>
                                <span style="float:right;">3</span>
                            </header>
                        </article>
                    </li>
                
                    <li>
                        <article>
                            <header>
                                <a href="/categories/golang/">golang</a>
                                <span style="float:right;">3</span>
                            </header>
                        </article>
                    </li>
                
                    <li>
                        <article>
                            <header>
                                <a href="/categories/dotnet-core/">dotnet-core</a>
                                <span style="float:right;">2</span>
                            </header>
                        </article>
                    </li>
                
                    <li>
                        <article>
                            <header>
                                <a href="/categories/draft/">draft</a>
                                <span style="float:right;">2</span>
                            </header>
                        </article>
                    </li>
                
                    <li>
                        <article>
                            <header>
                                <a href="/categories/github/">github</a>
                                <span style="float:right;">2</span>
                            </header>
                        </article>
                    </li>
                
                    <li>
                        <article>
                            <header>
                                <a href="/categories/helm/">helm</a>
                                <span style="float:right;">2</span>
                            </header>
                        </article>
                    </li>
                
                    <li>
                        <article>
                            <header>
                                <a href="/categories/vscode/">vscode</a>
                                <span style="float:right;">2</span>
                            </header>
                        </article>
                    </li>
                
                    <li>
                        <article>
                            <header>
                                <a href="/categories/websockets/">websockets</a>
                                <span style="float:right;">2</span>
                            </header>
                        </article>
                    </li>
                
                    <li>
                        <article>
                            <header>
                                <a href="/categories/brigade/">brigade</a>
                                <span style="float:right;">1</span>
                            </header>
                        </article>
                    </li>
                
                    <li>
                        <article>
                            <header>
                                <a href="/categories/csharp/">csharp</a>
                                <span style="float:right;">1</span>
                            </header>
                        </article>
                    </li>
                
                    <li>
                        <article>
                            <header>
                                <a href="/categories/grpc/">grpc</a>
                                <span style="float:right;">1</span>
                            </header>
                        </article>
                    </li>
                
                    <li>
                        <article>
                            <header>
                                <a href="/categories/iot/">iot</a>
                                <span style="float:right;">1</span>
                            </header>
                        </article>
                    </li>
                
                    <li>
                        <article>
                            <header>
                                <a href="/categories/jenkins/">jenkins</a>
                                <span style="float:right;">1</span>
                            </header>
                        </article>
                    </li>
                
                    <li>
                        <article>
                            <header>
                                <a href="/categories/wasm/">wasm</a>
                                <span style="float:right;">1</span>
                            </header>
                        </article>
                    </li>
                
                    <li>
                        <article>
                            <header>
                                <a href="/categories/windows-containers/">windows-containers</a>
                                <span style="float:right;">1</span>
                            </header>
                        </article>
                    </li>
                
            </ul>
        </section>
    

    
        

    
        <section id="footer">
            <ul class="icons">
                
                
                    
<li><a href="//github.com/radu-matei" target="_blank" title="GitHub" class="fa fa-github"></a></li>



















<li><a href="//instagram.com/iamradum" target="_blank" title="Instagram" class="fa fa-instagram"></a></li>

















<li><a href="//linkedin.com/in/mateiradu" target="_blank" title="LinkedIn" class="fa fa-linkedin"></a></li>















<li><a href="//twitter.com/matei_radu" target="_blank" title="Twitter" class="fa fa-twitter"></a></li>



<li><a href="mailto:root@radu.sh" title="Email" class="fa fa-envelope"></a></li>


                
            </ul>

            <p class="copyright">&copy; Radu Matei&#39;s Blog. Powered by <a href="//gohugo.io" target="_blank">Hugo</a></p>
        </section>

</section>

            </div>
        <a id="back-to-top" href="#" class="fa fa-arrow-up fa-border fa-2x"></a>
        
        

        
        
            
        

        
        
            <script src="/js/jquery.min.js"></script>
            <script src="/js/skel.min.js"></script>
            <script src="/js/util.js"></script>
            <script src="/js/main.js"></script>
            <script src="/js/backToTop.js"></script>
            <script src="/js/highlight.pack.js"></script>
        

        

            
            <script>hljs.initHighlightingOnLoad();</script>
            

            
    </body>
</html>

